function GetQueryStringParams(a,b){var c=""+window.location;if(-1==c.indexOf("?"))return b;c=c.substr(c.indexOf("?")+1);for(var d=c.split("&"),e=0;e<d.length;e++){var f=d[e].split("=");if(f[0]==a)return f[1]}return b}function initSigma(a){var c,d,e,b=a.data;c=a.sigma&&a.sigma.drawingProperties?a.sigma.drawingProperties:{defaultLabelColor:"#000",defaultLabelSize:14,defaultLabelBGColor:"#ddd",defaultHoverLabelBGColor:"#222",defaultLabelHoverColor:"#fff",labelThreshold:10,defaultEdgeType:"curve",defaultEdgeArrow:"target",hoverFontStyle:"",fontStyle:"",activeFontStyle:""},d=a.sigma&&a.sigma.graphProperties?a.sigma.graphProperties:{minNodeSize:1,maxNodeSize:7,minEdgeSize:.2,maxEdgeSize:.5},e=a.sigma&&a.sigma.mouseProperties?a.sigma.mouseProperties:{minRatio:5,maxRatio:20};var f=sigma.init(document.getElementById("sigma-canvas")).drawingProperties(c).graphProperties(d).mouseProperties(e);sigInst=f,f.active=!1,f.neighbors={},f.detail=!1,dataReady=function(){f.clusters={},f.iterNodes(function(a){f.clusters[a.color]||(f.clusters[a.color]=[]),f.clusters[a.color].push(a.id)}),f.bind("upnodes",function(a){nodeActive(a.content[0])}),f.draw(),f.position(0,0,1),f.zoomTo(f._core.domElements.nodes.width/2,f._core.domElements.nodes.height/2,2),configSigmaElements(a)},b.indexOf("gexf")>0||b.indexOf("xml")>0?f.parseGexf(b,dataReady):f.parseJson(b,dataReady),gexf=sigmaInst=null}function setupGUI(a){$GP={calculating:!1,showgroup:!1},$GP.intro=$("#intro"),$GP.minifier=$GP.intro.find("#minifier"),$GP.mini=$("#minify"),$GP.info=$("#attributepane"),$GP.info_donnees=$GP.info.find(".nodeattributes"),$GP.info_name=$GP.info.find(".name"),$GP.info_link=$GP.info.find(".link"),$GP.info_data=$GP.info.find(".data"),$GP.info_close=$GP.info.find(".returntext"),$GP.info_close2=$GP.info.find(".close"),$GP.info_p=$GP.info.find(".p"),$GP.info_close.click(nodeNormal),$GP.info_close2.click(nodeNormal),$GP.form=$("#mainpanel").find("form"),$GP.search=new Search($GP.form.find("#search")),a.GP=$GP,initSigma(a)}function configSigmaElements(c){$GP=c.GP,$GP.bg=$(sigInst._core.domElements.bg),$GP.bg2=$(sigInst._core.domElements.bg2),b={minWidth:400,maxWidth:800,maxHeight:600},$("a.fb").fancybox(b),$("#zoom").find("div.z").each(function(){var a=$(this),b=a.attr("rel");a.click(function(){if("center"==b){var a=sigInst._core;sigInst.position(0,0,1).draw()}else{var a=sigInst._core;sigInst.zoomTo(a.domElements.nodes.width/2,a.domElements.nodes.height/2,a.mousecaptor.ratio*("in"==b?1.5:.5))}})}),$GP.mini.click(function(){$GP.mini.hide(),$GP.intro.show(),$GP.minifier.show()}),$GP.minifier.click(function(){$GP.intro.hide(),$GP.minifier.hide(),$GP.mini.show()}),$GP.intro.find("#showGroups").click(function(){showGroups(1==$GP.showgroup?!1:!0)}),a=window.location.hash.substr(1),0<a.length&&($GP.search.exactMatch=!0,$GP.search.search(a),$GP.search.clean())}function Search(a){this.input=a.find("input[name=search]"),this.state=a.find(".state"),this.results=a.find(".results"),this.exactMatch=!1,this.lastSearch="",this.searching=!1;var b=this;this.input.focus(function(){var a=$(this);a.data("focus")||(a.data("focus",!0),a.removeClass("empty")),b.clean()}),this.input.keydown(function(a){return 13==a.which?(b.state.addClass("searching"),b.search(b.input.val()),!1):void 0}),this.state.click(function(){var a=b.input.val();b.searching&&a==b.lastSearch?b.close():(b.state.addClass("searching"),b.search(a))}),this.dom=a,this.close=function(){this.state.removeClass("searching"),this.results.hide(),this.searching=!1,this.input.val(""),nodeNormal()},this.clean=function(){this.results.empty().hide(),this.state.removeClass("searching"),this.input.val("")},this.search=function(a){var b=!1,c=[],b=this.exactMatch?("^"+a+"$").toLowerCase():a.toLowerCase(),d=RegExp(b);if(this.exactMatch=!1,this.searching=!0,this.lastSearch=a,this.results.empty(),2>=a.length)this.results.html("<i>En az 3 karakter girmeniz gerekmektedir.</i>");else{if(sigInst.iterNodes(function(a){(d.test(a.attr.attributes.name.toLowerCase())||d.test(a.label.toLowerCase()))&&c.push({id:a.id,name:a.label,full_name:a.attr.attributes.name})}),c.length?(b=!0,nodeActive(c[0].id)):b=showCluster(a),a=[],1<c.length)for(var e=0,f=c.length;f>e;e++)a.push('<div class="link-item"><a href="#'+c[e].name+'" onclick="nodeActive(\''+c[e].id+"')\">"+c[e].name+"</i></a></div>");0==c.length&&!b&&a.push("<i>Hi\xe7 kullan\u0131c\u0131 bulunamad\u0131.</i>"),this.results.html(a.join(""))}1!=c.length&&this.results.show(),1==c.length&&this.results.hide()}}function Cluster(a){this.cluster=a,this.display=!1,this.list=this.cluster.find(".list"),this.list.empty(),this.select=this.cluster.find(".select"),this.select.click(function(){$GP.cluster.toggle()}),this.toggle=function(){this.display?this.hide():this.show()},this.content=function(a){this.list.html(a),this.list.find("a").click(function(){var a=$(this).attr("href").substr(1);showCluster(a)})},this.hide=function(){this.display=!1,this.list.hide(),this.select.removeClass("close")},this.show=function(){this.display=!0,this.list.show(),this.select.addClass("close")}}function showGroups(a){a?($GP.intro.find("#showGroups").text("Hide groups"),$GP.bg.show(),$GP.bg2.hide(),$GP.showgroup=!0):($GP.intro.find("#showGroups").text("View Groups"),$GP.bg.hide(),$GP.bg2.show(),$GP.showgroup=!1)}function nodeNormal(){1!=$GP.calculating&&0!=sigInst.detail&&(showGroups(!1),$GP.calculating=!0,sigInst.detail=!0,$GP.info.delay(400).animate({width:"hide"},350),sigInst.iterEdges(function(a){a.attr.color=!1,a.hidden=!1}),sigInst.iterNodes(function(a){a.hidden=!1,a.attr.color=!1,a.attr.lineWidth=!1,a.attr.size=!1}),sigInst.draw(2,2,2,2),sigInst.neighbors={},sigInst.active=!1,$GP.calculating=!1,window.location.hash="")}function colorLuminance(a,b){a=String(a).replace(/[^0-9a-f]/gi,""),a.length<6&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),b=b||0;var d,e,c="#";for(e=0;3>e;e++)d=parseInt(a.substr(2*e,2),16),d=Math.round(Math.min(Math.max(0,d+d*b),255)).toString(16),c+=("00"+d).substr(d.length);return c}function rgbToHex(a){return a=a.replace(/[^\d,]/g,"").split(","),"#"+((1<<24)+(+a[0]<<16)+(+a[1]<<8)+ +a[2]).toString(16).slice(1)}function nodeActive(a){var b=!1;config.informationPanel.groupByEdgeDirection&&1==config.informationPanel.groupByEdgeDirection&&(b=!0),sigInst.neighbors={},sigInst.detail=!0;var c=sigInst._core.graph.nodesIndex[a];showGroups(!1);var d={},f={},g={};sigInst.iterEdges(function(b){b.attr.lineWidth=!1,b.hidden=!0,n={name:b.label,colour:b.color},a==b.source?d[b.target]=n:a==b.target&&(f[b.source]=n),(a==b.source||a==b.target)&&(sigInst.neighbors[a==b.target?b.source:b.target]=n),b.hidden=!1,b.attr.color="rgba(0, 0, 0, 1)"});var h=[];if(sigInst.iterNodes(function(a){a.hidden=!0,a.attr.lineWidth=!1,a.attr.color=a.color}),b)for(e in d)e in f&&(g[e]=d[e],delete f[e],delete d[e]);var i=function(b){var e,c=[],d=[];for(e in b){var f=sigInst._core.graph.nodesIndex[e];f.hidden=!1,f.attr.lineWidth=!1,f.attr.color=b[e].colour,a!=e&&d.push({id:e,name:f.label,full_name:f.attr.attributes.name,avatar:f.attr.attributes.avatar,group:b[e].name?b[e].name:"",colour:b[e].colour})}d.sort(function(a,b){var c=a.group.toLowerCase(),d=b.group.toLowerCase(),e=a.name.toLowerCase(),f=b.name.toLowerCase();return c!=d?d>c?-1:c>d?1:0:f>e?-1:e>f?1:0}),f="";for(e in d)b=d[e],c.push('<div class="link-item"><a href="#'+b.name+'" onmouseover="sigInst._core.plotter.drawHoverNode(sigInst._core.graph.nodesIndex[\''+b.id+"'])\" onclick=\"nodeActive('"+b.id+'\')" onmouseout="sigInst.refresh()">'+b.name+"</a></div>");return c},h=[];b?(size=Object.size(g),h.push("<h2>Kar\u015f\u0131l\u0131kl\u0131 Takip Ettikleri ("+size+")</h2>"),h.push('<div class="links">'),size>0?h=h.concat(i(g)):h.push("Kar\u015f\u0131l\u0131kl\u0131 takip edilen kullan\u0131c\u0131 bulunamad\u0131.<br>"),h.push('</div><div class="clearfix"></div>'),size=Object.size(f),h.push("<h2>Kar\u015f\u0131l\u0131ks\u0131z Takip Edenler ("+size+")</h2>"),h.push('<div class="links">'),size>0?h=h.concat(i(f)):h.push("Bu kullan\u0131c\u0131y\u0131 takip eden biri bulunamad\u0131.<br>"),h.push('</div><div class="clearfix"></div>'),size=Object.size(d),h.push("<h2>Kar\u015f\u0131l\u0131ks\u0131z Takip Ettikleri ("+size+")</h2>"),h.push('<div class="links">'),size>0?h=h.concat(i(d)):h.push("Bu kullan\u0131c\u0131 kimseyi takip etmiyor.<br>"),h.push('</div><div class="clearfix"></div>')):h=h.concat(i(sigInst.neighbors)),c.hidden=!1,c.attr.color=c.color,c.attr.lineWidth=6,c.attr.strokeStyle="#000000",sigInst.draw(2,2,2,2),$GP.info_link.html(h.join(""));var j=rgbToHex(c.color);if($GP.info_link.find(".link-item").css("backgroundColor",colorLuminance(j,-.5)),$GP.info_link.find(".link-item").each(function(){var a=$(this);a.attr("rel")}),h=c.attr,h.attributes){var k=!1;config.informationPanel.imageAttribute&&(k=config.informationPanel.imageAttribute),$GP.info_name.html('<div class="row profile-info"><div class="col-md-2"><img src='+h.attributes[k].replace("normal","400x400")+' style="vertical-align:middle" /></div><div class="col-md-10"> <span class="name" onmouseover="sigInst._core.plotter.drawHoverNode(sigInst._core.graph.nodesIndex[\''+c.id+'\'])" onmouseout="sigInst.refresh()">'+h.attributes.name+'</span><br><span class="username" onmouseover="sigInst._core.plotter.drawHoverNode(sigInst._core.graph.nodesIndex[\''+c.id+'\'])" onmouseout="sigInst.refresh()">@'+c.label+"</span></div></div>")}$GP.info_data.show(),$GP.info.css("backgroundColor",h.color.replace(")",", 0.6)").replace("rgb","rgba")),$GP.info.animate({width:"show"},350),$GP.info_donnees.hide(),$GP.info_donnees.show(),sigInst.active=a,window.location.hash=c.label}function showCluster(a){var b=sigInst.clusters[a];if(b&&0<b.length){showGroups(!1),sigInst.detail=!0,b.sort(),sigInst.iterEdges(function(a){a.hidden=!1,a.attr.lineWidth=!1,a.attr.color=!1}),sigInst.iterNodes(function(a){a.hidden=!0});for(var c=[],d=[],e=0,f=b.length;f>e;e++){var g=sigInst._core.graph.nodesIndex[b[e]];1==g.hidden&&(d.push(b[e]),g.hidden=!1,g.attr.lineWidth=!1,g.attr.color=g.color,c.push('<li class="membership"><a href="#'+g.label+'" onmouseover="sigInst._core.plotter.drawHoverNode(sigInst._core.graph.nodesIndex[\''+g.id+"'])\" onclick=\"nodeActive('"+g.id+'\')" onmouseout="sigInst.refresh()">'+g.label+"</a></li>"))}return sigInst.clusters[a]=d,sigInst.draw(2,2,2,2),$GP.info_name.html("<b>"+a+"</b>"),$GP.info_data.hide(),$GP.info_p.html("Group Members:"),$GP.info_link.find("ul").html(c.join("")),$GP.info.animate({width:"show"},350),$GP.search.clean(),$GP.cluster.hide(),!0}return!1}var sigInst,canvas,$GP,config={};jQuery.getJSON(GetQueryStringParams("config","config.json"),function(a,b,c){return config=a,"network"!=config.type?void alert("Invalid configuration settings."):void $(document).ready(setupGUI(config))}),Object.size=function(a){var c,b=0;for(c in a)a.hasOwnProperty(c)&&b++;return b};
